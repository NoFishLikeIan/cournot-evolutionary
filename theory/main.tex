\documentclass[american]{scrartcl}
    \usepackage{babel}
    \usepackage[utf8]{inputenc} 
    \usepackage{csquotes}
    \usepackage{amsmath}
    \usepackage{amssymb}
    \usepackage{graphicx} 
    \usepackage{subfigure}
    \usepackage{mathtools}
    \usepackage{float}
    \usepackage{fancyvrb} % for "\Verb" macro

    
    \setlength{\parindent}{0em}
    \setlength{\parskip}{0.5em}

    % Bibliography and citations
    \usepackage[bibencoding=utf8, style=apa]{biblatex}
    \bibliography{ref}

    
    \title{A model of Cournot Competition with group selection}


    \author{Andrea Titton}
    

% Commands
\newcommand{\set}[1]{\left\{#1\right\}}
\newcommand{\Real}{\mathbb{R}}
\newcommand{\Rat}{\mathbb{Q}}
\newcommand{\abs}[1]{\left\lvert #1 \right\rvert}
\newcommand{\Two}{\mathbf{2}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\citein}[1]{\citeauthor{#1} (\citeyear{#1})}

\begin{document}

% Title

\maketitle

\section{Introduction}


In this short paper I propose to study the dynamics of equilibrium formation in Cournot competition through an evolutionary lens. The aim is to study the formation and sustainability of tacit collusion among firm. I develop a model with local markets competing à la Cournot. Firms evolve in a birth-death process. This can be thought of as firms copying a production technology from the best performing competitor in their own local market, after a certain amount of periods. Here the standard result applies: tacit collusion is stable only for a small number of firms (\cite{Lampart2012}). The model is then extended to encompass group effects, based on the framework by \citein{Akdeniz2020}. In particular, I show how tacit collusion can be sustained for larger oligopolies, as long as competition at a group level (i.e. between local markets) emerges slowly.

\section{Literature review}

In 1838, Antoine Augustin Cournot introduced his famous model of competition over quantities. Since then, the model has served as a theoretical benchmark for pure oligopolistic models in economic theory. In Cournot oligopolies, a discrete number of firms compete by setting quantities of a perfectly substitutable good. In equilibrium, due to symmetry, all firms produce the same quantity and any deviations by producers reduces their own profit.

In proposing the model, Cournot does not address the way in which firms form their strategies. Modern economics relies on rational expectations to justify the symmetric equilibrium solution. More contemporary approaches have derived the model dynamics under limited knowledge (\cite{Bischi2015}) or naive expectations (\cite{Cnovas2008}). All of these approaches lead to equilibria that are unstable as the number of firms increases (Cournot–Theocharis problem).

In order to better model and understand the emergence of such instability I will rely on an evolutionary framework developed by \citein{Akdeniz2020}. The authors analyse the role of group selection in the emergence of cooperation. As in previous models, defection gives a fitness advantage at an individual level (within groups) but a disadvantage at a group level (across groups). Furthermore, groups do not compete globally but only with neighboring groups. The authors show how local competition among groups has strong implications for the emergence of cooperation.

\section{Theoretical formulation}

As in \citein{Akdeniz2020}, the game is played within groups (hereafter, local markets). Firms compete locally à la Cournot. Each period, with some probability, a global event occurs. During a global event, firms of neighboring nodes participate in the game. % FIXME: This is not clearly state

This mechanisms is different from that of group reproduction in the baseline framework (\cite{Akdeniz2020}) because it represents a more realistic assumption in the case of firms competing and itj better encodes the tradeoffs between tacit collusion and competition.

\subsection{Notation}

Any variable $x^{(i)}_t$ is indexed such that the superscript refers to the individual and the subscript to time.

\subsection{Local competition}

Local markets are composed by $N$ firms, indexed by $i$, that can choose a production quantity $q^{(i)} \in \Sigma \subset \Rat_+$. Firms face linear demand,

\begin{equation}
    p(Q) = p\left(q^{(1)}, q^{(2)},  \ldots, q^{(N)} \right) = a - b \cdot \sum^{N}_{i=1} q^{(i)}
\end{equation}

where $Q$ is the vector of quantities, and linear marginal costs,

\begin{equation}
    c(q) = c \cdot q
\end{equation}

All of these assumptions can be easily relaxed to allow for non-linear demand, entry costs, and marginal costs. The symmetric Nash equilibrium of the game is (Appendix \ref{A:cournot}),

\begin{equation} \label{equilib}
    \bar{q}= \frac{a - c}{b \cdot (N+1)}
\end{equation}

The model evolves in discrete time $t \in \set{0, 1, \ldots T}$. At $t = 0$, a fixed proportion of firms plays the Cournot equilibrium strategy $\bar{q}$ and the remaining play a strategy sampled from the strategy set, $q^{(i)}_0 \sim U(\Sigma)$. In every period each company realizes a payoff, $\Pi^{(i)}_t = p(Q_t) \cdot q^{(i)}_t - c(q^{(i)})$. I assume that firms reproduce in a birth-death process. That is, each turn, with a probability proportional to its payoffs, a firm is picked to reproduce and, with uniform probability, a firm is picked to die. In particular, the probability of a firm $j$ being picked for reproduction is, % FIXME: Better scaling

\begin{equation}
    \frac{\Pi^{(j)}}{\sum^n_{i = 1} \Pi^{(i)}}.
\end{equation}


This modelling choice is justified in the context of oligopolies where firms copy other firms' production quantities in case the competitor is experiencing better profits. This arises for example in the airline industry, where capacity (number of flights) has to be planned \textit{ex-ante} to comply with regulations. Furthermore, these are markets with high barriers to entry (fixed $N$), long-term investment commitments (randomness in the birth-death process), and common tacit collusion.

\subsection{Global competition}

In the model, there are $M$ local markets and each local market is linked to two other neighboring markets, thus forming a cycle (as in \cite{Akdeniz2020}). Each turn, with probability $\rho$, a local market is involved in a global event. In this case, firms of neighboring markets are involved in the competition for birth. Hence the probability of a firm $j$ from a market $m$ being selected for reproduction is,

\begin{equation}
    \frac{\Pi^{(j)}}{\sum_{i \in (m-1) \cup m \cup (m+1)} \Pi^{(i)}}
\end{equation}

This choice introduces a tradeoff in firms' strategies. Playing a quantity above Cournot increases the firm's payoffs relative to other firms, hence increasing its reproduction probability, but it also reduces the overall payoff of the local market, thereby reducing the reproduction probability in case of a global event.

\section{Simulation}

To reproduce the simulation see Appendix \ref{A:code}.

In the simulations I set $a = 200$, $c = 5$, and $b = 1$, such that equation (\ref{equilib}) yields,

\begin{equation}
    \bar{q}(N) = \frac{195}{N+1}
\end{equation}

Furthermore, $N \cdot 0.4$ firms start off playing the equilibrium quantity $\bar{q}(N)$ and $N \cdot 0.6$ play a random quantity.

\subsection{Local market}

First we can focus on a simulation of a local market, without group effects (i.e. no global competition). In particular here we look at the evolution of quantities and prices, first with a concentrated market ($N = 5$) and then with a competitive market ($N = 20$). The values of $N$ are set to these values heuristically based on the simulation results.

Figure \ref{fig:small_local} shows a quantity heat map for one of the runs, with $T = 200$, in the case of a concentrated market. Each row represents a firm in the market and each column a time step. Darker colors are associated with smaller quantities. As expected, quantities converge very rapidly to the Cournot quantity $\bar{q}(5) \approx 81.67$.

\begin{center}
    \begin{figure}[H]
        \center
        \includegraphics[width=0.8\textwidth]{../plots/small/low/localquantity.png}
        \caption{Quantity evolution in a concentrated market}
        \label{fig:small_local}
    \end{figure}
\end{center}

Figure \ref{fig:price_small_local} displays the price evolution $p(Q_t)$ for $100$ periods of $20$ local markets of size $5$. Most markets converge % FIXME: Why is the equil. quantity different?!

\begin{center}
    \begin{figure}[H]
        \center
        \includegraphics[width=0.8\textwidth]{../plots/small/low/meanprice.png}
        \caption{Price evolution in a concentrated market}
        \label{fig:price_small_local}
    \end{figure}
\end{center}

If we turn our attention to a highly competitive markets and we repeat the exercise, the dynamics change drastically. In particular, Figure \ref{fig:large_local} shows the evolution of strategies of a single run. Here firms fail to collude and prices tend towards the equilibrium.

\begin{center}
    \begin{figure}[H]
        \center
        \includegraphics[width=0.8\textwidth]{../plots/big/low/localquantity.png}
        \caption{Quantity evolution in a competitive market}
        \label{fig:large_local}
    \end{figure}
\end{center}

The lack of collusion can be seen more clearly in the 150 simulations run of price in Figure \ref{fig:price_large_local}.

\begin{center}
    \begin{figure}[H]
        \center
        \includegraphics[width=0.8\textwidth]{../plots/big/low/meanprice.png}
        \caption{Price evolution in a competitive market}
        \label{fig:price_large_local}
    \end{figure}
\end{center}

\subsection{Global markets}

In order to study the effect of groups on the equilibria of the game we first look at a simple simulation run with, as before, $N = 5$ and $M = 4$. In Figure \ref{fig:small_avg}, two lines, representing the average quantity in each group, are plotted with the same color if in that period the local markets are merged. Already from a single run we can see how tacit collusion can be sustained in larger groups, if these arise from smaller prior groups which were in a tacit collusive equilibrium. In fact the previous simulation with $N = 20$ and no group effects does not sustain collusion but $M = 4$ and $N = 5$ does (note that $M\cdot N = 20$ is the long run size of the group as all groups will be merged).

\begin{figure}[H]
    \center
    \includegraphics[width=0.8\textwidth]{../plots/small/high/localquantity.png}
    \caption{Average quantities with $4$ markets of size $5$}
    \label{fig:small_avg}
\end{figure}


\begin{figure}[H]
    \center
    \includegraphics[width=0.8\textwidth]{../plots/small/high/meanprice.png}
    \caption{Profits with $4$ markets of size $5$}
    \label{fig:small_avg_profit}
\end{figure}



\begin{figure}[H]
    \center
    \includegraphics[width=0.95\textwidth]{../plots/big/high/meanprice.png}
    \caption{Expected market size for different $\rho$s.}
    \label{fig:size}
\end{figure}

\section{Conclusions}

In this short paper I present a tentative analysis of the dynamics of an oligopolistic market with Cournot competition and group structure. In particular I show how, ceteris paribus, tacit collusion can be sustained for larger market sizes in the presence of slowly merging local markets. The analysis is by no means exhaustive. In particular it lacks an analytical derivation of the relationship between $M$ and $\rho$, and the instability of tacit collusion. Nevertheless, I believe that introducing group structure and evolutionary dynamics can help greatly in modelling the dynamical aspects of Cournot games. This yields a new point of view and can serve as a stepping stone to explain the presence of tacit collusion in apparently competitive markets.

\newpage
% Bibliography
\nocite{*}
\pagenumbering{gobble} % stop page numbering
\printbibliography

\newpage
\appendix

\section{Cournot equilibrium} \label{A:cournot}

Let $q^{(-i)} = Q \setminus \set{i}$. Then the payoff function of firm $i$ is,

\begin{equation*}
    \Pi\left(q^{(i)}, q^{(-i)} \right) = q^{(i)} \cdot p(Q)
\end{equation*}

Then the best response strategy, under ration expectations, is,

\begin{equation*}
    \begin{split}
        \bar{q} = \arg\max_{q} \Pi\left(q, q^{(-i)} \right),
    \end{split}
\end{equation*}

which yields the first order condition,

\begin{equation*}
    \bar{q} \cdot \frac{ \partial p}{\partial q}\left(\bar{q}, q^{(-1)}\right) + p\left(\bar{q}, q^{(-1)}\right) = 0.
\end{equation*}

With a linear demand function, by symmetry it is straight forward to show that,

\begin{equation*}
    \bar{q} = \frac{a}{b \cdot (N+1)}
\end{equation*}

\section{Expected size of global markets} \label{A:exp_size}

Consider the case of $\rho = 1$. Then the expected size of a group sampled at time $t$ is,

\begin{equation*}
    \begin{split}
        \E[N_0 \vert \ \rho = 1] &= N \cdot \frac{M}{M} \\
        \E[N_1 \vert \ \rho = 1] &=  N \cdot \frac{M}{M-1}  \\
        \E[N_2 \vert \ \rho = 1] &=  \frac{1}{M-1} \cdot \left[ \frac{3N + (M-3) \cdot N}{M-2} \right] + \frac{M-2}{M-1} \cdot \left[ \frac{2 \cdot 2N + (M-4) \cdot N}{M-2} \right] \\ &= N \cdot \frac{M}{M-2} \\
        &\vdots \\
        &= N \cdot \frac{M}{M-t}
    \end{split}
\end{equation*}

This result can intuitively be derived by noticing that the total number of firms across markets is constant at $N \cdot M$ but the number of group decreases by $1$ at every merger. Now, for an arbitrary $\rho$ it is trivial to see that $\E[N_0] = N$. Furthermore,

\begin{equation*}
    \begin{split}
        \E[N_t] &= \underbrace{(1 - \rho) \cdot \E[N_{t-1}]}_{\text{no event}} + \underbrace{\rho \cdot \frac{N \cdot M}{M-t}}_{\text{merger event}} \\
        &= (1 - \rho) \cdot \left[ (1 - \rho) \cdot \E[N_{t-2}] + \rho \cdot \frac{N \cdot M}{M - (t-1)} \right] + \rho \cdot \frac{N \cdot M}{M-t} \\
        &=(1 - \rho)^2 \cdot  \E[N_{t-2}] + \rho \cdot (1 - \rho) \cdot \frac{N \cdot M}{M - (t - 1)} + \rho \cdot \frac{N\cdot M}{M-t} \\
        &= (1 - \rho)^3 \cdot  \E[N_{t-3}] + \rho \cdot (1 - \rho)^2 \cdot \frac{N \cdot M}{M - (t - 2)} + \rho \cdot (1 - \rho) \cdot \frac{N \cdot M}{M - (t - 1)} + \rho \cdot \frac{N\cdot M}{M-t}  \\
        &\vdots \\
        &= (1 - \rho)^t \cdot \underbrace{\E[N_0]}_{N} + \rho \cdot \sum^{t-1}_{i = 0} (1 - \rho)^{i} \cdot \frac{N \cdot M}{M - (t - i)}
    \end{split}
\end{equation*}


\section{Simulation code} \label{A:code}

The code can be found at,

\begin{verbatim}
    github.com/NoFishLikeIan/tinbergen/tree/master/code/evolutionary
\end{verbatim}

The simulation requires \verb+Julia v.1.5.x > +. A simulation to produce all graphs is available as,

\begin{verbatim}
    julia main.jl
\end{verbatim}

and to run the coalition size simulation as,

\begin{verbatim}
    julia coalitionsize.jl
\end{verbatim}




\end{document}